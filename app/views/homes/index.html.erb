<head>
     <%= stylesheet_link_tag :home %>
</head>

<%= button_to 'Log-Out',destroy_user_session_path, method: :delete %>

<body>
    <div class="container">
        <div class="all-card">
            <% @posts.each do |post| %>
                <div class="card" data-controller="like" 
                        data-like-user-id-value="<%= current_user.id %>" data-like-likeable-id-value="<%= post.id %>" data-like-likeable-type-value= "<%= post.class %>" >
                    <div class="top">
                        <div class="userDeatils">
                            <div class="profileImg">
                                <%#= image_tag user_image_url(post.user), class: "cover" %>
                                <%= image_tag user_image_url(post.user.profile), class: "cover"%>
                            </div>
                            <h3><%= post.user[:username] %></h3>
                        </div>
                        <div class="dot">
                            <%= image_tag 'more.png', class: "heart" %>
                        </div>
                    </div>
                    <div class="imgBg">
                        <%= image_tag post.image, class: "cover" if post.image.attached? %>
                    </div>
                    <div class="btns">
                        <div class="left">
                            <%#= image_tag 'heart.svg', class: "heart" %>
                            <div data-controller="comment" 
                                data-comment-user-id-value="<%= current_user.id %>" data-comment-commentable-id-value="<%= post.id %>" data-comment-commentable-type-value= "<%= post.class %>" >
                                    <%= image_tag  "#{ exist_like_or_not(post.id, 'Post') ? 'like-image.png' : 'heart.svg' }", data: { action: "click->like#onClicked", like_target: 'likeImage' } %>
                                    <%= link_to new_comment_path(post: post) , data: {turbo_stream: :true} do %>
                                        <%= image_tag "comment.svg" %>
                                    <% end %>
                                    <%= image_tag 'share.svg', class: "heart" %>
                            </div>
                        </div>
                        <div class="right">
                            <%= image_tag 'bookmark.svg', class: "heart" %>
                        </div>
                    </div>
                    
                    <%#= turbo_stream_from 'likes_count' %>
                    <div id = 'likes_count'>
                        <div class="likes" data-like-target='Count'><%= post.likes.count %> likes</div> 
                    </div>

                    <h4 class="message">
                        <b><h3><%= post.user[:username] %></h3></b>
                        <p>
                            <%= post.desc %>
                        </p>
                    </h4><br>
                    <a>
                        <%= post.comments.count %> Comments
                    </a>
                    <br>

                    <%= render post.comments %>
                    <%= turbo_frame_tag "#{post.id}_comment" %> 

                  

                    <div class="addComments">
                        <div class="userImg">
                            <%= image_tag user_image_url(post.user.profile), class: "cover"%>
                        </div>
                        <%= turbo_frame_tag dom_id(post)%> 
                    </div>
                </div>
            <% end %>
        </div>

        <div class="sidebar">
        <div>
            <div class="top">
                <div class="userDeatils">
                    <div class="profileImg">
                        <%= image_tag user_image_url(current_user.profile), class: "cover"  %>
                    </div>
                    <p><%= current_user.username %></p>
                </div>
                <h5>Suggestions for you</h5>
                <div class="userDeatils">
                    <div class="profileImg">
                        <%= image_tag 'default-user.png', class: "cover" %>
                    </div>
                    <p>Nikhil Kumar<br><span>Web Designer</span></p>
                </div>

                <div class="userDeatils">
                    <div class="profileImg">
                        <%= image_tag 'default-user.png', class: "cover" %>
                    </div>
                    <p>Nikhil Kumar<br><span>Web Designer</span></p>
                </div>

                <div class="userDeatils">
                    <div class="profileImg">
                        <%= image_tag 'default-user.png', class: "cover" %>
                    </div>
                    <p>Nikhil Kumar<br><span>Web Designer</span></p>
                </div>

                <div class="userDeatils">
                    <div class="profileImg">
                        <%= image_tag 'default-user.png', class: "cover" %>
                    </div>
                    <p>Nikhil Kumar<br><span>Web Designer</span></p>
                </div>

                <div class="userDeatils">
                    <div class="profileImg">
                        <%= image_tag 'default-user.png', class: "cover" %>
                    </div>
                    <p>Nikhil Kumar<br><span>Web Designer</span></p>
                </div>

                <div class="userDeatils">
                    <div class="profileImg">
                        <%= image_tag 'default-user.png', class: "cover" %>
                    </div>
                    <p>Nikhil Kumar<br><span>Web Designer</span></p>
                </div>
            </div>
        </div>
        </div>
    </div>


    <script>
                function likeButton(){
            let heart = document.querySelector('.heart');
            let likes = document.querySelector('.likes');
            if(heart.src.match("heart.png")){
                heart.src = "heart_red.png";
                likes.innerHTML = "5,490 likes";
            } else {
                heart.src = "heart.png";
                likes.innerHTML = "5,489 likes"
            }
        }
    </script>

</body>

</html>

